Para este **Script** se importarán dos módulos: `OS` , `SHUTIL`, con ellos buscaremos acceder a la maquina victima 

![[Pasted image 20230622182453.png]]

## Shutil

El módulo "shutil" es un módulo de la biblioteca estándar de Python que proporciona varias funciones de alto nivel para operaciones de manipulación de archivos y directorios. "shutil" significa "shell utilities" (utilidades de shell), y su objetivo es facilitar tareas comunes relacionadas con la manipulación de archivos y directorios, similares a las que se pueden realizar desde una línea de comandos.

El módulo "shutil" incluye funciones para copiar, mover, renombrar y eliminar archivos y directorios. También proporciona métodos para trabajar con enlaces simbólicos y archivos de archivo (archivos comprimidos), así como para cambiar los permisos de archivos y directorios.

Algunas de las funciones más utilizadas del módulo "shutil" son:

- shutil.copy(src, dst): Copia el archivo en la ruta de origen (src) a la ruta de destino (dst).
- shutil.move(src, dst): Mueve el archivo en la ruta de origen (src) a la ruta de destino (dst).
- shutil.rmtree(path): Elimina un directorio y todo su contenido de forma recursiva.
- shutil.make_archive(base_name, format, root_dir): Crea un archivo de archivo comprimido que contiene todo el contenido de un directorio.
- shutil.chown(path, user=None, group=None): Cambia el propietario y/o grupo de un archivo o directorio.

### os.chdir 

En Python, puedes utilizar la función `os.chdir()` del módulo `os` para cambiar el directorio de trabajo actual del proceso en ejecución. La función `os.chdir()` toma como argumento la ruta del directorio al que deseas cambiar y lo establece como el directorio actual.

![[Pasted image 20230622131802.png]]
https://eternallybored.org/misc/netcat/netcat-win32-1.11.zip

Como podemos ver en la linea 4 estamos descargando un archivo y lo guardamos con el nombre netcat.zip, en la siguiente linea utilizamos el archivo **shutil.unpack_archive** para descomprimir el archivo que guardamos anteriormente, ya con las ultimas instrucciones entramos en el archivo que nos da al descomprimir y ejecutamos el exe, la dirección IP que vemos en pantalla es la del atacante (Kali Linux) con su puerto para poder estar a la escucha cuando se ejecute el script. 

![[Pasted image 20230622141328.png]]
Antes de ejecutar el script debemos ponernos a la escucha en nuestra terminal de linux con el comando nc -nlvp y nuestro puerto que escribimos en el script de python, damos enter y nos dirá que estará escuchando hasta que se ejecute el script

## nc -nlvp

El comando `nc -nlvp` es una combinación de opciones utilizadas con la herramienta `nc` (netcat) en la línea de comandos. Estas opciones se usan para iniciar un servidor de escucha en un puerto específico y esperar conexiones entrantes.

Aquí está el significado de cada opción:

- `-n`: Esta opción deshabilita la resolución inversa de DNS, evitando que `nc` intente resolver las direcciones IP en nombres de host.
- `-l`: Esta opción indica a `nc` que inicie un servidor de escucha.
- `-v`: Esta opción habilita el modo verbose (detallado) y muestra información adicional en la salida.

La opción `-p` generalmente se utiliza junto con `-l` y se utiliza para especificar el número de puerto en el que se desea escuchar. Sin embargo, en la combinación `nc -nlvp`, la opción `-p` no se incluye explícitamente porque es opcional y si no se proporciona, `nc` utilizará un puerto aleatorio disponible.

En resumen, al ejecutar `nc -nlvp` en la línea de comandos, estás indicando a `nc` que inicie un servidor de escucha en un puerto específico o aleatorio y que muestre información detallada sobre las conexiones entrantes. Este comando es útil para escuchar y manejar conexiones entrantes desde otros hosts.

![[Pasted image 20230622141522.png]]

Una vez entramos en escucha podemos navegar por los directorios y archivos dentro del cmd de windows de la victima, con esto también podemos crear directorios, eliminar, mover y demás 

## Nota: 
Para que el archivo responda de manera efectiva, se necesita desactivar los antivirus que puedan haber, ya que el netcat al ser descargado por medio del script en python o desde el navegador lo identifica como un virus.

Descargamos una librería llamada pyinstaller, utilizamos el comando **pip install pyinstaller** 
dentro de la consola escribimos lo siguiente comando, con esto hacemos que nuestro script de convierta en un archivo exe.

![[Pasted image 20230622230321.png]]

Una vez termina la instalación tenemos el siguiente directorio y si ejecutamos el archivo que encontramos dentro no lo detectará el antivirus

![[Pasted image 20230622232823.png]]
![[Pasted image 20230622232945.png]]
